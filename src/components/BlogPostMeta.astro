---
import type { ProcessedPost, PostMeta, BreadcrumbItem } from '../utils/blogUtils';
import Breadcrumb from './Breadcrumb.astro';
import Icon from './Icon.astro';
import { 
  generatePostMeta, 
  generateBreadcrumbs
} from '../utils/blogUtils';

export interface Props {
  post: ProcessedPost;
  includeBreadcrumbs?: boolean;
}

const { post, includeBreadcrumbs = true } = Astro.props;

// Generar metadatos para mostrar en la UI
const postMeta: PostMeta = generatePostMeta(post);
const breadcrumbs: BreadcrumbItem[] = includeBreadcrumbs ? generateBreadcrumbs(post) : [];
---

<!-- Breadcrumbs visuales -->
{includeBreadcrumbs && breadcrumbs.length > 0 && (
  <Breadcrumb 
    items={breadcrumbs} 
    align="left" 
    variant="minimal" 
    includeSchema={true}
  />
)}

<!-- Metadatos del post -->
<div class="flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-6">
  <!-- Fecha de publicación -->
  <div class="flex items-center">
    <Icon name="calendar" class="w-4 h-4 mr-2" />
    <time datetime={post.data.pubDate}>{postMeta.publishDate}</time>
  </div>
  
  <!-- Tiempo de lectura -->
  <div class="flex items-center">
    <Icon name="clock" class="w-4 h-4 mr-2" />
    {postMeta.readingTime}
  </div>
  
  <!-- Autor -->
  <div class="flex items-center">
    <Icon name="user" class="w-4 h-4 mr-2" />
    {postMeta.author}
  </div>
  
  <!-- Categoría -->
  {post.data.category && (
    <div class="flex items-center">
      <Icon name="tag" class="w-4 h-4 mr-2" />
      <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
        {post.data.category}
      </span>
    </div>
  )}
</div>

<!-- Tags -->
{post.data.tags && post.data.tags.length > 0 && (
  <div class="flex flex-wrap gap-2 mb-6">
    {post.data.tags.map((tag: string) => (
      <span class="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-slate-100 text-slate-700">
        {tag}
      </span>
    ))}
  </div>
)}
